<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <meta name="_csrf" th:content="${_csrf.token}" />
    <style>
        .fa-star.checked {
            color: #deb217;
        }
    </style>
</head>
<header th:replace="~{partials/head.html :: header}">
</header>
<body class="profile-page">


<div th:unless="${#authorization.expression('isAuthenticated()')}">
    <nav th:insert="~{partials/nav-bar.html :: nav-bar}"></nav>
</div>
<div th:if="${#authorization.expression('isAuthenticated()')}">
    <nav th:insert="~{partials/nav-bar.html :: nav-bar2}"></nav>
</div>


<div class="row" style="display: flex">
    <div class="column">
        <div class="card-main-profile profile-card">
            <div class="card-stuff-profile">
                <div class="pfp circle">Profile Picture</div>
                <h1 class="username-h1"><span class="span-username" th:text="${user.username}"></span></h1>
                <p class="email-p" th:text="${user.email}"></p>
                <button class="edit-profile-btn"><a th:href="@{/profile/edit/{id}(id = ${ user.getId()})}">Edit Profile</a></button>
            </div>
        </div>
    </div>
    <div class="column">
        <div class="visited-text">
        <h1>Recently Visited Breweries</h1>
    </div>
    <div class="container review-container">

        <th:block th:each="review, iterStat : ${userReviews}">
            <!-- Use th:if to check if the index is less than 5 -->
            <div th:if="${iterStat.index < 5}" class="reviewBox-container">
                <div class="review-card">
                    <div class="card-stuff">
                        <img th:src="${review.image}" class="review-image">

                        <p class="rating"  hidden="hidden" th:text="${review.rating}"></p>
                        <p th:hidden="true" class="rating" th:text="${review.getRating()}"></p>
                        <span class="fa fa-star"></span>
                        <span class="fa fa-star"></span>
                        <span class="fa fa-star"></span>
                        <span class="fa fa-star"></span>
                        <span class="fa fa-star"></span>
                    </div>

                        <div class="brewery-name" th:text="${review.breweryName}">
                            </div>
                        <h5 class="card-title" th:text="${review?.description}"></h5>
                        <button class="card-button">
                            <!-- Link to view individual review -->
                            <a th:href="@{/view-review/{id}(id=${review.id})}">View Review</a>
                        </button>
                    </div>
                </div>

        </th:block>
</div>
        <div class="all-reviews-btn">
            <button class="view-all-button">
                <!-- Link to another page with all reviews -->
                <a th:href="@{/all-reviews}">View All Reviews</a>
            </button>
        </div>
    </div>
</div>


<!--    <h3 class="user-reviews-text">User Reviews</h3>-->
<script src="//static.filestackapi.com/filestack-js/3.x.x/filestack.min.js"></script>
<script type="module" src="/js/stars.js"></script>
</body>
</html>